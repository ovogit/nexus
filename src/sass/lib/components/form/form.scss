$comet-background-color-input = $comet-background-color-default;
$comet-background-color-input-disabled = $comet-color-neutral-90;
$comet-background-color-input-error = $comet-background-color-default;
$comet-background-color-input-hover = $comet-color-neutral-95;

$comet-border-color-input = $comet-color-neutral-55;
$comet-border-color-input-hover = $comet-color-neutral-25;
$comet-border-color-input-focus = $comet-color-interactive-default;
$comet-border-color-input-error = $comet-color-feedback-error;

$comet-border-width-input-error = 2px;

$comet-border-input = solid 1px $comet-border-color-input;
$comet-border-input-hover = solid 1px $comet-border-color-input-hover;
$comet-border-input-focus = solid 1px $comet-border-color-input-focus;
$comet-border-input-error = solid $comet-border-width-input-error $comet-border-color-input-error;

$comet-border-radius-input = $comet-border-radius;

$comet-size-input-height = 40px;
$comet-size-input-max-width = 700px;
$comet-size-input-max-width-xs = $comet-size-default * 4;
$comet-size-input-max-width-s = $comet-size-default * 8;
$comet-size-fieldset-max-width = 700px;
$comet-size-radio-button-checkbox = $comet-size-icon-l;
$comet-size-textarea-min-height = 280px;

$comet-space-inset-input = $comet-space-inset-stretch-s;
$comet-space-input-stack = $comet-space-stack-xs;
$comet-space-field-stack = $comet-space-stack-default;
$comet-space-label-stack = $comet-space-stack-s;
$comet-space-radio-checkbox-horizontal-offset = $comet-space-default; // Used to vertically align horizontal radio button groups with input fields and select boxes

$comet-text-color-checkmark = $comet-color-interactive-default;
$comet-text-color-error = $comet-color-feedback-error;
$comet-text-color-input = $comet-text-color-default;
$comet-text-color-input-disabled = $comet-text-color-disabled;
$comet-text-color-input-hover = $comet-text-color-default;
$comet-text-color-label = $comet-text-color-default;
$comet-text-color-microcopy = $comet-text-color-default;
$comet-text-color-placeholder = $comet-text-color-light;
$comet-text-color-radio-button = $comet-color-interactive-default;
$comet-text-color-select-indicator = $comet-color-interactive-default;


$comet-font-size-form-input-dense = 1rem;
$comet-font-size-form-label-dense = 1rem;
$comet-font-size-microcopy-dense = .875rem;
$comet-space-inset-input-dense = $comet-space-inset-xs;
$comet-size-radio-button-checkbox-dense = $comet-size-icon-s;
$comet-space-fieldset-stack-dense = $comet-space-stack-xs;
$comet-space-label-stack-dense = $comet-space-stack-xs;
$comet-size-input-height-dense = 30px;
$comet-space-radio-checkbox-horizontal-offset-dense = 3px; // Used to vertically align horizontal radio button groups with input fields and select boxes


.comet-form {
    font-family: $comet-font-family-display;
}

.comet-form--contained {
    background: $comet-background-color-light;
    border-radius: $comet-border-radius;
    padding: $comet-space-inset-l;
}

.comet-form__input,
.comet-form__textarea {
    &::placeholder {
        color: $comet-text-color-placeholder;
        opacity: 1;
    }
}

.comet-form__input {
    appearance: none;
    background: $comet-background-color-input;
    border: $comet-border-input;
    border-radius: $comet-border-radius-input;
    color: $comet-text-color-input;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-form-input;
    margin: $comet-space-input-stack;
    max-width: $comet-size-input-max-width;
    padding: $comet-space-inset-input;
    width: 100%;

    &:disabled {
        background: $comet-background-color-input-disabled;
        cursor: not-allowed;
        opacity: 1;
    }

    &:focus {
        border: $comet-border-input-focus;
        outline: 0;
    }
}

.comet-form__textarea {
    appearance: none;
    background: $comet-background-color-input;
    border: $comet-border-input;
    border-radius: $comet-border-radius-input;
    color: $comet-text-color-input;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-form-input;
    margin: $comet-space-input-stack;
    max-width: $comet-size-input-max-width;
    min-height: $comet-size-textarea-min-height;
    padding: $comet-space-inset-stretch-s;
    width: 100%;

    &:disabled {
        background: $comet-background-color-input-disabled;
        cursor: not-allowed;
        opacity: 1;
    }

    &:focus {
        border: $comet-border-input-focus;
        outline: 0;
    }
}

.comet-form__field-group {
    display: block;
    font-family: $comet-font-family-display;
    margin: $comet-space-field-stack;
    max-width: $comet-size-input-max-width;
    width: 100%;
}

.comet-form__field-group--xs {
    max-width: $comet-size-input-max-width-xs;
}

.comet-form__field-group--s {
    max-width: $comet-size-input-max-width-s;
}

.comet-form__field-group--horizontal {
    align-items: flex-start;
    display: flex;
    font-size: 0;

    & > * {
        margin-bottom: 0;
        margin-right: $comet-space-default;

        &:last-child {
            margin-right: 0;
        }
    }
}

.comet-form__label {
    color: $comet-text-color-label;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-form-label;
    margin: $comet-space-label-stack;
    max-width: $comet-size-input-max-width;
}

.comet-form__label-required-indicator {
    color: $comet-text-color-error;
    margin-left: $comet-space-xs;
}

.comet-form__microcopy {
    color: $comet-text-color-microcopy;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-microcopy;
    max-width: $comet-size-input-max-width;

    .comet-form__label + & {
        display: block;
        margin: $comet-space-label-stack;
        margin-top: -($comet-space-label-stack);
    }
}

.comet-form__field-error {
    align-items: flex-start;
    color: $comet-text-color-error;
    display: none;
    font-size: $comet-font-size-messaging;
    margin: $comet-space-stack-default;
    max-width: $comet-size-input-max-width;
    
    .comet-form--error & {
        display: flex;
    }
}

.comet-form__field-error-text {
    vertical-text-crop();
    margin-top: 2px;
}

.comet-form__field-error-icon {
    fill: $comet-color-feedback-error;
    flex-grow: 0;
    flex-shrink: 0;
    height: $comet-size-icon-s;
    margin: $comet-space-inline-left-s;
    width: $comet-size-icon-s;
}

.comet-form__required-fields-key {
    color: $comet-text-color-error;
    display: inline-block;
    font-size: $comet-font-size-messaging;
    margin: $comet-space-field-stack;

    &:before {
        color: $comet-text-color-error;
        content: '*\A0';
    }
}

.comet-form__checkbox,
.comet-form__radio-button {
    align-items: flex-start;
    cursor: pointer;
    display: inline-flex;
    max-width: $comet-size-input-max-width;
    position: relative;
    
    &:hover {
        .comet-form__checkbox-visual,
        .comet-form__radio-button-visual {
            background: $comet-background-color-input-hover;
            border-color: $comet-border-color-input-hover;
        }
    }
}

.comet-form__checkbox-input,
.comet-form__radio-button-input {
    cursor: pointer;
    opacity: 0;
    position: absolute;

    &:focus {
        + .comet-form__checkbox-visual,
        + .comet-form__radio-button-visual {
            border-color: $comet-border-color-input-focus;
            outline: $comet-border-color-input dotted 1px; //FF IE
            outline: -webkit-focus-ring-color auto 5px;
        }
    }
}

.comet-form__checkbox-visual,
.comet-form__radio-button-visual {
    background: $comet-background-color-input;
    border: $comet-border-input;
    border-radius: $comet-border-radius-input;
    cursor: pointer;
    flex-grow: 0;
    flex-shrink: 0;
    height: $comet-size-radio-button-checkbox;
    margin-right: $comet-size-s;
    position: relative;
    text-align: center;
    width: $comet-size-radio-button-checkbox;
    transition: background $comet-transition-default, border-color $comet-transition-default;


    .comet-form__checkbox-input:checked + & {
        .comet-form__checkbox-checked-icon {
            display: block;
        }
    }

    .comet-form__checkbox-input:focus + &, {
        border-color: $comet-border-input-focus;
    }

    .comet-form__checkbox-input:disabled + &,
    .comet-form__radio-button-input:disabled + & {
        background: $comet-background-color-input;
        border-color: $comet-border-color-input;
        cursor: not-allowed;
    }
}

.comet-form__checkbox-checked-icon {
    display: none;
    fill: $comet-text-color-checkmark;
    height: $comet-size-icon-s;
    left: 50%;
    margin-left: -($comet-size-icon-s / 2);
    margin-top: -($comet-size-icon-s / 2);
    position: absolute;
    top: 50%;
    width: $comet-size-icon-s;
}

.comet-form__radio-button-visual {
    border-radius: 50%;

    .comet-form__radio-button-input:checked + & {
        &:before {
            background: $comet-text-color-radio-button;
            border: solid 3px $comet-color-white;
            border-radius: 50%;
            content: '';
            display: block;
            height: 100%;
            width: 100%;
        }
    }


    .comet-form__radio-button-input:focus + & {
        border-color: $comet-border-color-input-focus;
    }
}

.comet-form__checkbox-text,
.comet-form__radio-button-text {
    vertical-text-crop();
    color: $comet-text-color-label;
    cursor: pointer;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-form-label;
    margin-top: 6px;

    .comet-form__radio-button-input:disabled ~ &,
    .comet-form__checkbox-input:disabled ~ & {
        color: $comet-text-color-input-disabled;
        cursor: not-allowed;
    }
}

.comet-form__select {
    background: none;
    border: 0;
    height: $comet-size-input-height;
    margin: $comet-space-input-stack;
    max-width: $comet-size-input-max-width;
    position: relative;
    width: 100%;
}

.comet-form__select-input {
    appearance: none;
    background: none;
    border: 0;
    color: $comet-text-color-input;
    cursor: pointer;
    font-size: $comet-font-size-form-input;
    height: 100%;
    padding: $comet-space-inset-input;
    padding-bottom: 0;
    padding-right: $comet-size-input-height;
    padding-top: 0;
    position: relative;
    width: 100%;
    z-index: 10;

    &::-ms-expand {
        display: none;
    }

    &:-moz-focusring {
        color: transparent;
        text-shadow: 0 0 0 $comet-text-color-input;
    }

    &:focus {
        outline: 0;
    }

    &:disabled {
        color: $comet-text-color-input-disabled;
        cursor: not-allowed;
    }
}

.comet-form__select-visual-wrap {
    background: $comet-background-color-input;
    border: $comet-border-input;
    border-radius: $comet-border-radius-input;
    bottom: 0;
    cursor: pointer;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    z-index: 0;

    .comet-form__select-input:focus ~ & {
        border: $comet-border-input-focus;
    }

    .comet-form__select-input:hover ~ & {
        background: $comet-color-neutral-95;
        border: $comet-border-input-hover;
    }

    .comet-form__select-input:disabled ~ & {
        background: $comet-background-color-input-disabled;
        border-color: $comet-border-color-input;
        cursor: not-allowed;
    }
}

.comet-form__select-open-indicator {
    background: $comet-background-color-input;
    border: $comet-border-input;
    border-radius: 0 $comet-border-radius-input $comet-border-radius-input 0;
    bottom: 0;
    content: '';
    display: block;
    height: $comet-size-input-height;
    position: absolute;
    right: -1px;
    text-align: center;
    top: 0;
    width: $comet-size-input-height;
    z-index: 5;

    .comet-form__select-input:focus ~ & {
        border: $comet-border-input-focus;
    }

    .comet-form__select:hover & {
        background: $comet-color-neutral-95;
        border: $comet-border-input-hover;
    }

    .comet-form__select-input:disabled ~ & {
        background: $comet-background-color-input-disabled;
        border-color: $comet-border-color-input;
        cursor: not-allowed;

        .comet-form__select-open-icon {
            fill: $comet-text-color-input-disabled;
        }
    }
}

.comet-form__select-open-icon {
    cursor: pointer;
    display: inline;
    fill: $comet-text-color-select-indicator;
    height: $comet-size-icon-s;
    left: 50%;
    margin-left: -($comet-size-icon-s / 2);
    margin-top: -($comet-size-icon-s / 2);
    position: absolute;
    top: 50%;
    width: $comet-size-icon-s;
}

.comet-form__checkbox-group {
    border: 0;
    margin: 0;

    .comet-form__checkbox {
        display: flex;
        margin: $comet-space-stack-s;
    }

    .comet-form__field-group--horizontal & .comet-form__checkbox {
        display: inline-flex;
        margin-bottom: $comet-space-default;
        margin-left: $comet-space-s;
        margin-right: $comet-space-default;
        position: relative;
        top: $comet-space-radio-checkbox-horizontal-offset;

        &:last-child {
            margin-right: 0;
        }
    }
}

.comet-form__checkbox-group-label,
.comet-form__radio-button-group-label {
    color: $comet-text-color-label;
    display: block;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-form-label;
    margin: $comet-space-label-stack;
    max-width: $comet-size-input-max-width;
}

.comet-form__radio-button-group {
    border: 0;
    margin: 0;

    .comet-form__radio-button {
        display: flex;
        margin: $comet-space-stack-s;
    }

    .comet-form__field-group--horizontal & .comet-form__radio-button {
        display: inline-flex;
        margin-bottom: $comet-space-default;
        margin-left: $comet-space-s;
        margin-right: $comet-space-default;
        position: relative;
        top: $comet-space-radio-checkbox-horizontal-offset;

        &:last-child {
            margin-right: 0;
        }
    }
}

.comet-form__fieldset {
    background: $comet-background-color-default;
    border: $comet-border-input;
    border-radius: $comet-border-radius-input;
    margin: $comet-space-stack-l;
    max-width: $comet-size-fieldset-max-width;
    padding: $comet-space-inset-default; // No bottom padding because the last field group in the fieldset will have $comet-space-l bottom margin
    padding-bottom: 0;
    width: 100%;
}

.comet-form__legend {
    color: $comet-text-color-input;
    font-family: $comet-font-family-display;
    font-size: $comet-font-size-header-level-4;
    margin: 0;
}

*.comet-form--error,
.comet-form--error *:not(a) {
    border-color: $comet-border-color-input-error;
    border-width: $comet-border-width-input-error;
}

.comet-form__checkbox-group-label,
.comet-form__radio-button-group-label {
    + .comet-form__microcopy {
        margin-top: -($comet-space-s);
        margin-bottom: $comet-space-default;
    }
}

.comet-form__field-group--collapse {
    flex: 0;
}

// DENSE FORM VARIATION

.comet-form__input,
.comet-form__textarea {

    .comet-form--dense &,
    &.comet-form--dense {
        font-size: $comet-font-size-form-input-dense;
        padding: $comet-space-inset-input-dense;
    }
}

.comet-form__label,
.comet-form__field-error,
.comet-form__legend {
    .comet-form--dense &,
    &.comet-form--dense {
        font-size: $comet-font-size-form-label-dense;
        margin-bottom: $comet-space-label-stack-dense;
    }
}

.comet-form__microcopy {
    .comet-form--dense &,
    &.comet-form--dense {
        font-size: $comet-font-size-microcopy-dense;
    }
}


.comet-form__radio-button-group .comet-form__radio-button,
.comet-form__radio-button, .comet-form__checkbox {
    .comet-form--dense &,
    &.comet-form--dense {
        padding: 2px 0px; //exception to achieve minimum 44px touch target size: 16px control + 2px top/bottom margin = 20px object
        margin-bottom: 12px; //exception to achieve minimum 44px touch target size: 12px margin top + [object] + 12px margin bottom
    }
}

.comet-form__checkbox-group-label + .comet-form__microcopy, 
.comet-form__radio-button-group-label + .comet-form__microcopy {
    .comet-form--dense &,
    &.comet-form--dense {
        margin-bottom: $comet-space-s;
    }
}

.comet-form__checkbox-visual,
.comet-form__radio-button-visual {
    .comet-form--dense &,
    &.comet-form--dense {
        height: $comet-size-radio-button-checkbox-dense;
        width: $comet-size-radio-button-checkbox-dense;
    }
}

.comet-form__checkbox-checked-icon {
    .comet-form--dense &,
    &.comet-form--dense {
        height: $comet-size-icon-xs;
        margin-left: -($comet-size-icon-xs / 2);
        margin-top: -($comet-size-icon-xs / 2);
        width: $comet-size-icon-xs;
    }
}

.comet-form__checkbox-text,
.comet-form__radio-button-text,
.comet-form__checkbox-group-label,
.comet-form__radio-button-group-label {
    .comet-form--dense &,
    &.comet-form--dense {
        vertical-text-crop(
            line-height: $comet-font-line-height-s, 
            font-size: $comet-font-size-form-label-dense);
        font-size: $comet-font-size-form-label-dense;
        line-height: $comet-font-line-height-s;
    }
}

.comet-form__checkbox-text,
.comet-form__radio-button-text {
    .comet-form--dense &,
    &.comet-form--dense {
        margin-top: $comet-space-radio-checkbox-horizontal-offset-dense;
    }
}

.comet-form__field-group {
    .comet-form--dense &,
    &.comet-form--dense {
        margin-bottom: calc($comet-space-stack-m * 0.75);
    }
}

.comet-form__fieldset {
    .comet-form--dense &,
    &.comet-form--dense {
        padding: $comet-space-inset-s;
        padding-bottom: 0;
        margin-bottom: $comet-space-m;        
    }
}

.comet-form__field-group--horizontal {
    .comet-form--dense &,
    &.comet-form--dense {
        & > * {
            margin-right: $comet-space-s;
        }

        .comet-form__radio-button-group .comet-form__radio-button {
            top: 0;
        }
        .comet-form__checkbox-group .comet-form__checkbox {
            top: 0;
        }
    }
}

.comet-form__select {
    .comet-form--dense &,
    &.comet-form--dense {
        height: $comet-size-input-height-dense;
        margin: $comet-space-input-stack;
    }
}

.comet-form__select-input {
    .comet-form--dense &,
    &.comet-form--dense {
        font-size: $comet-font-size-form-input-dense;
        padding: $comet-space-inset-input-dense;
        padding-right: $comet-size-input-height-dense;
    }
}

.comet-form__select-open-indicator {
    .comet-form--dense &,
    &.comet-form--dense {
        height: $comet-size-input-height-dense;
        right: -1px;
        top: 0;
        width: $comet-size-input-height-dense;
    }
}

.comet-form__select-open-icon {
    .comet-form--dense &,
    &.comet-form--dense {
        height: $comet-size-icon-xs;
        margin-left: -($comet-size-icon-xs / 2);
        margin-top: -($comet-size-icon-xs / 2);
        width: $comet-size-icon-xs;
    }
}

