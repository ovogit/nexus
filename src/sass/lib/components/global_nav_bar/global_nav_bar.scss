$nxs-background-color-global-nav: $nxs-color-neutral-15;
$nxs-background-color-util-links : #0B0C0F;
$nxs-background-color-link-global-nav-bar-hover : $nxs-color-neutral-25;
$nxs-background-color-link-global-nav-bar-active : $nxs-color-neutral-22;
$nxs-customization-panel-background : #13141A;
$nxs-font-size-more-nav-header-text : $nxs-font-size-pill;
$nxs-color-nav-text : $nxs-color-neutral-80;
$nxs-color-nav-text-hover : $nxs-color-white;
$nxs-background-color-selected-item : $nxs-color-neutral-25;

.nxs-global-nav-bar {
    text-body();
    background: $nxs-background-color-global-nav;
    display: flex;
    flex-direction: column;
    position: relative;
    width: 100%;
    
    // Icons have to be nested inside .nxs-global-nav-bar to have enough specificity to override nxs-list-group
    .nxs-global-nav-bar__item-icon {
        pointer-events: none;
        height: $nxs-size-icon-l;
        fill: $nxs-color-neutral-65;
        flex: 0 0 $nxs-size-icon-l;
        margin-bottom: -6px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 24px tall so we're shaving 6px off the top and bottom
        margin-top: -6px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 24px tall so we're shaving 6px off the top and bottom
        transition: fill nxs-page-shell-transition-snap(); // Sadly this transition doesn't work in Safari since the SVG is inside a link, won't fix for now

        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            fill: $nxs-color-nav-text;
            transition: fill nxs-page-shell-transition-reveal(); // Sadly this transition doesn't work in Safari since the SVG is inside a link, won't fix for now
        }
    }
    
    // Selected state theme colors have to be nested inside .nxs-global-nav-bar to have enough specificity to override nxs-list-group styles
    &.nxs-global-nav-bar--theme-product-science {
        .nxs-global-nav-bar__item--selected:before {
            background-color: $nxs-theme-product_science-color-light;
        }
    }

    &.nxs-global-nav-bar--theme-product-math {
        .nxs-global-nav-bar__item--selected:before {
            background-color: $nxs-theme-product_math-color-light;
        }
    }

    &.nxs-global-nav-bar--theme-product-social-studies {
        .nxs-global-nav-bar__item--selected:before {
            background-color: $nxs-theme-product_social_studies-color-light;
        }
    }

    &.nxs-global-nav-bar--theme-product-streaming {
        .nxs-global-nav-bar__item--selected:before {
            background-color: $nxs-theme-product_streaming-color-light;
        }
    }
    
    // Selected state modifier colors have to be nested inside .nxs-global-nav-bar to have enough specificity to override nxs-list-group styles
    .nxs-global-nav-bar__item--selected {
        background-color: $nxs-background-color-selected-item;
        
        &:hover {
            .nxs-global-nav-bar__item-label {
                color: $nxs-color-nav-text-hover;
            }
        }
        
        &.nxs-global-nav-bar__item--draggable:hover:before {
            // Remove "selected" indicator color bar so draggable handle can be revealed
            width: 0;
        }
        
        .nxs-page-shell--global-nav-bar-customizing &:before {
            width: 0;
        }
    }
}

.nxs-global-nav-bar__list-group {
    background: $nxs-background-color-global-nav;
    flex-shrink: 0;
}

.nxs-global-nav-bar__header {
    align-items: center;
    color: $nxs-color-white;
    display: flex;
    flex-shrink: 0;
    margin-top: $nxs-space-default;
    padding: $nxs-space-inset-default;
    padding-bottom: 0;
    padding-top: 0;
    
    &:hover {
        background: $nxs-background-color-link-global-nav-bar-hover;
    }
    
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        padding-left: $nxs-space-s;
        transition: padding nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s);
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            padding-left: $nxs-space-default;
            transition: padding nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m);
        }
    }
}

.nxs-global-nav-bar__brand-logo-wrap {
    height: 63px;
    position: relative;
    width: 100%;
}

.nxs-global-nav-bar__item-sort-placeholder {
    background: $nxs-customization-panel-background;
    min-height: 56px;
    width: 100%;
}

.nxs-global-nav-bar__item--sorting .nxs-global-nav-bar__item-icon,
.nxs-global-nav-bar__link:hover .nxs-global-nav-bar__item-icon {
    fill: $nxs-color-nav-text-hover;
}

// Nested selector to override nxs list group dark theme default
.nxs-global-nav-bar {
    .nxs-global-nav-bar__item-label {
        vertical-text-crop();
        color: $nxs-color-nav-text;
    }

    .nxs-global-nav-bar__item--sorting .nxs-global-nav-bar__item-label,
    .nxs-global-nav-bar__link:hover .nxs-global-nav-bar__item-label {
        color: $nxs-color-nav-text-hover;
    }
}

.nxs-global-nav-bar__customize-panel {
    background: $nxs-customization-panel-background;
    box-shadow: 0 40px 0 $nxs-customization-panel-background;
    flex-shrink: 0;
    margin-bottom: 40px;
    margin-top: auto;
    overflow: hidden;

    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        margin-bottom: 0;
        opacity: 0;
        transition: opacity nxs-page-shell-transition-snap();
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            opacity: 1;
            transition: opacity nxs-page-shell-transition-reveal();
        }
    }
}

.nxs-global-nav-bar__customize-panel-actions {
    height: 0;
    min-height: 0;
    overflow: hidden;
    text-align: center;
    transition: min-height nxs-page-shell-transition-snap();

    .nxs-page-shell--global-nav-bar-customizing & {
        min-height: 120px;
        transition: min-height nxs-page-shell-transition-reveal();
    }
}

.nxs-global-nav-bar__customization-trigger {
    align-items: center;
    border-radius: 0;
    display: flex;
    justify-content: center;
    padding-right: 36px;
    text-decoration: none;
    transition: background $nxs-transition-default;
    width: 100%;
    
    &:hover {
        background: $nxs-background-color-selected-item;
    }
    
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        height: auto;
    }
}

.nxs-global-nav-bar__customization-icon {
    fill: $nxs-color-nav-text;
    transition: transform nxs-page-shell-transition-snap();

    .nxs-global-nav-bar__customization-trigger:hover & {
        fill: $nxs-color-nav-text-hover;
    }
    
    .nxs-page-shell--global-nav-bar-customizing & {
        transform: rotate(180deg);
        transition: transform nxs-page-shell-transition-reveal();
    }
    
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        transform: rotate(180deg);
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always & {
            transform: rotate(0deg);
            transition: transform nxs-page-shell-transition-reveal();
        }
        
        // Repeat this rule so it still applies when the nav is expanded
        .nxs-page-shell--global-nav-bar-customizing & {
            transform: rotate(180deg);
            transition: transform nxs-page-shell-transition-reveal();
        }
    }
}

.nxs-global-nav-bar__customization-text {
    color: $nxs-color-nav-text;
    margin-left: $nxs-space-xs;
    text-decoration: none;

    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        position: relative;
        left: $nxs-space-l;
        transition: left nxs-page-shell-transition-snap();
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            left: 0;
            transition: left nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m, $nxs-page-shell-transition-duration-xs);
        }
    }
}

.nxs-global-nav-bar__reset-menu {
    background: transparent;
    border-radius: 0;
    width: 100%;
    transition: background $nxs-transition-default;
    
    &:hover {
        background: $nxs-background-color-selected-item;
    }
}

.nxs-global-nav-bar__customize-panel-save {
    padding: $nxs-space-inset-default;

    .nxs-button:last-child {
        margin-right: 0;
    }
}

// Extra specificity to overcome display: flex on list group
.nxs-global-nav-bar .nxs-global-nav-bar__item--home {
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        display: none;
    }
}

.nxs-global-nav-bar__brand-logo-small {
    height: 0;
    left: 0;
    overflow: hidden;
    position: absolute;
    top: 0;
    transition: opacity nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s, $nxs-page-shell-transition-duration-xs);
    visibility: hidden;
    width: 40px;
    z-index: 0;

    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        height: auto;
        opacity: 1;
        top: 10px;
        transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m, $nxs-page-shell-transition-duration-xs);
        visibility: visible;
    }
}

.nxs-global-nav-bar__brand-logo-full {
    left: 0;
    position: absolute;
    top: 10px;
    width: 185px;
    
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        opacity: 0;
        overflow: hidden;
        transition: opacity nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s, $nxs-page-shell-transition-duration-xs);
        z-index: 5;
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            opacity: 1;
            transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m, $nxs-page-shell-transition-duration-xs);
        }
    }
}

.nxs-global-nav-bar__item-label {
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        opacity: 0;
        left: $nxs-space-default;
        position: relative;
        transition: opacity nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s), left nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s);
        
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always &,
        .nxs-page-shell--global-nav-bar-customizing & {
            left: 0;
            opacity: 1;
            transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m, $nxs-page-shell-transition-duration-xs), left nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m, $nxs-page-shell-transition-duration-xs);
        }
    }
}

.nxs-global-nav-bar__item.nxs-global-nav-bar__item--sorting {
    background: $nxs-background-color-link-global-nav-bar-hover;
}

// Triple selector to override specificity of .nxs-list-group--row-inset-m .nxs-list-group__row-anchor
.nxs-global-nav-bar .nxs-global-nav-bar__item .nxs-global-nav-bar__link {
    @media screen and (min-width: $nxs-breakpoints-tablet-portrait) {
        padding-left: $nxs-space-default + 3px;
        transition: padding nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s);
        
        .nxs-page-shell--global-nav-bar-customizing &,
        .nxs-page-shell--global-nav-bar-expanded &,
        .nxs-page-shell--global-nav-bar-expanded-always & {
            padding-left: $nxs-space-default;
            transition: padding nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m);
        }
    }
}

.nxs-global-nav-bar__more-items {
    
    .nxs-global-nav-bar__item .nxs-global-nav-bar__item-icon {
        opacity: 0;
        transition: opacity nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s);
 
        &.nxs-global-nav-bar__item--sorting {
            transition: none;
            transition: opacity nxs-page-shell-transition-snap($nxs-page-shell-transition-duration-s);
        }
    }
    
    .nxs-page-shell--global-nav-bar-expanded-always &,
    .nxs-page-shell--global-nav-bar-expanded &,
    .nxs-page-shell--global-nav-bar-visible &  {
        
        .nxs-global-nav-bar__item .nxs-global-nav-bar__item-icon {
            opacity: 1;
            transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-m);
     
            &.nxs-global-nav-bar__item--sorting {
                transition: none;
            }
        }
    }
}

.nxs-global-nav-bar__more-nav-header {
    opacity: 0
    border-top: 1px solid $nxs-color-nav-text-hover;
    margin: 0 $nxs-space-default+20 $nxs-space-default $nxs-space-default
    transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-s);

    .nxs-page-shell--global-nav-bar-expanded-always &,
    .nxs-page-shell--global-nav-bar-expanded &,
    .nxs-page-shell--global-nav-bar-visible & {
        opacity: 1
        transition: opacity nxs-page-shell-transition-reveal($nxs-page-shell-transition-duration-l);
    }
}

.nxs-global-nav-bar__customize-sortable-target {
    align-items: center;
    display: flex;
    flex-shrink: 0;
    margin: $nxs-space-inline-left-xs;
    
    .nxs-page-shell--global-nav-bar-customizing & {
        cursor: grab;
    }
}

.nxs-global-nav-bar__item-grip-wrap {
    cursor: grab;
    display: flex;
    flex: 0 0 $nxs-size-icon-s;
    fill: $nxs-color-white;
    margin-left: -($nxs-size-icon-s); // "pull" to the left the same distance as the icon's width;
    opacity: 0;
    visibility: hidden;
    transition opacity nxs-page-shell-transition-snap(), visibility nxs-page-shell-transition-snap(0, $nxs-page-shell-transition-duration-default); // Wait to change visibility until after opacity fades out

    .nxs-global-nav-bar__item--sorting &,
    .nxs-global-nav-bar__link:hover & {
        align-items: center;
        display: flex;
        opacity: 1;
        transition: none;
        visibility: visible;
    }
    
    .nxs-page-shell--global-nav-bar-customizing & {
        display: flex;
        opacity: 1;
        transition opacity nxs-page-shell-transition-reveal();
        visibility: visible;
    }
}

.nxs-global-nav-bar__item-grip-icon {
    width: $nxs-size-icon-s;
    height: $nxs-size-icon-s;
    
    margin-bottom: -2px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 16px tall so we're shaving 2px off the top and bottom
    margin-top: -2px; // "shrink" height of icon so it takes up no more space than the text which is 12px tall. Icons are 16px tall so we're shaving 2px off the top and bottom
}

.nxs-global-nav-bar__item--sorting {
    .nxs-global-nav-bar__item-grip-wrap,
    .nxs-global-nav-bar__link {
        cursor: grabbing;
    }
}

.nxs-global-nav-bar__items--more-hidden-dropzone {
    min-height: 56px;
    margin: 0;
    padding: 0;
    
    .nxs-page-shell--global-nav-bar-expanded-always &,
    .nxs-global-nav-bar--more-nav-expanded & {
        display: none;
    }
}
